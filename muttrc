# Automatically log in to this mailbox at startup
#set spoolfile="imaps://mackenza:****@exchange.lancs.ac.uk/"
#set folder="imaps://mackenza:****@exchange.lancs.ac.uk/"
 ## activate TLS if available on the server
 #set ssl_starttls=yes
 ## always use SSL when connecting to a server
 #set ssl_force_tls=yes
 ## wait to enter mailbox manually
 #set imap_passive
 # Automatically poll subscribed mailboxes for new mail (new in 1.5.11)
 #set imap_check_subscribed
 
set mbox_type=Maildir
set folder="/media/mackenza/overflow/Maildir/"
set spoolfile = "+INBOX" 
set signature="/home/mackenza/signature.txt"
set record="=Sent"
set postponed="=Drafts"

mailboxes +INBOX
mailboxes +@ACTIONS
mailboxes +director_ug
mailboxes +sociology
mailboxes +supervision

 # Reduce polling frequency to a sane level
 set mail_check=6
 # And poll the current mailbox more often (not needed with IDLE in post 1.5.11)
 set timeout=10
 # keep a cache of headers for faster loading (1.5.9+?)
 set header_cache=~/.hcache
 # Display download progress every 5K
 set net_inc=5
#
set smtp_url = "smtp://rian39@smtp.gmail.com:587/"  # ESMTP with TLS
set from="a.mackenzie@lancaster.ac.uk"
set realname="adrian mackenzie"

set query_command= "abook --mutt-query '%s'"
macro index,pager  a "<pipe-message>abook --add-email-quiet<return>" "Add this sender to Abook"
bind editor        <Tab> complete-query

### BEGIN NOTMUCH-MUTT SETTINGS
macro index  \
              "unset wait_key~/.mutt/mutt-notmuch.pl --prompt search~/.cache/mutt_results" \
                        "search mail (using notmuch)"
macro index  \
                                      "unset wait_key~/.mutt/mutt-notmuch.pl thread~/.cache/mutt_resultsset wait_key" \
                                    "search and reconstruct owning thread (using notmuch)"

 #'L' performs a notmuch query, showing only the results
 #macro index L "<enter-command>unset wait_key<enter><shell-escape>read -p 'notmuch query: ' x; echo \$x >~/.cache/mutt_terms<enter><limit>~i \"\`notmuch search --output=messages \$(cat ~/.cache/mutt_terms) | head -n 600 | perl -le '@a=<>;chomp@a;s/\^id:// for@a;$,=\"|\";print@a'\`\"<enter>" "show only messages matching a notmuch pattern"
             # 'a' shows all messages again (supersedes default <alias> binding)
                 #macro index a "<limit>all\n" "show all messages (undo limit)"

# Use abook with Mutt
 set query_command="abook --mutt-query '%s'"
 macro index a     "|abook --add-email\n" 'add sender to abook'
 macro pager a     "|abook --add-email\n" 'add sender to abook'

 set text_flowed=yes
 bind pager j next-line
 bind pager k previous-line
 bind attach,index,pager \CD next-page
 bind attach,index,pager \CU previous-page
 bind pager g top
 bind pager G bottom
 bind attach,index g first-entry
 bind attach,index G last-entry

 bind index N search-opposite
 bind pager N search-opposite

set index_format="%4C %Z %D %-15.15L  %s"

set sidebar_visible = yes
macro index b '<enter-command>toggle sidebar_visible<enter><refresh>'
macro pager b '<enter-command>toggle sidebar_visible<enter><redraw-screen>'
set sidebar_delim   = ' â”‚ '
set sidebar_width   = 24
color sidebar_new color221 color233

 # Ctrl-n, Ctrl-p to select next, previous folder.
 # # Ctrl-o to open selected folder.
  bind index,pager \CP sidebar-prev
  bind index,pager \CN sidebar-next
  bind index,pager \CO sidebar-open
set sidebar_sort = yes

set fast_reply=yes
set include=yes

auto_view text/html                                      # view html automatically
alternative_order text/plain text/enriched text/html     # save html for last

# Palette for use with the Linux console.  Black background.

color hdrdefault blue black
color quoted blue black
color signature blue black
color attachment red black
color message brightred black
color error brightred black
color indicator black red
color status brightgreen blue
color tree white black
color normal white black
color markers red black
color search white black
color tilde brightmagenta black
color index blue black ~F
color index red black "~N|~O"

# color body brightwhite black '\*+[^*]+\*+'
# color body brightwhite black '_+[^_]+_+'
